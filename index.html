<!DOCTYPE html>
<html>
<head>
<title>ODBC Connect</title>


<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<link rel="stylesheet" href="CSS/Style.css">
</head>
<body>

<div class="pagediv">

    <nav class="navbar navbar-inverse navbar-fixed-top">
        <h1>ODBC Connect</h1>
    </nav>


    <div class="contentDiv">
        <div class="tableofcontent">
            <h2>Table of content</h2>
    
            <ol>
                <li><a href="#preparingDatabaseTableDiv">Preparing Database Table</a></li>
                <li><a href="#preparingBlueprintDiv">Preparing Blueprint</a></li>
                <li><a href="#connectionStringdiv">Setting ConnectionString</a></li>
                <li><a href="#gettingDatabaseManagerDiv">Getting Database Manager</a></li>
                <li>
                    <a href="#executeStatementFunctionDiv">ExecuteStatement Function </a>
                    <!--  <ol>
                        <li>
                            <a href="#step3div">Connection String</a>
                        </li> 
                        <li>
                            <a href="#step3div">Connection String</a>
                        </li> 
                    </ol>-->
                </li>
                <li><a href="#gettingDataDiv">Getting Data From Database</a></li>
                <li><a href="#gettingAffectedRowsCountDiv">Getting Affected Rows Count</a></li>
                <li><a href="#statementTagDiv">Statement Tag</a></li>
            </ol>
    
        </div>
    
        <div class="guideDiv"> 
    
            <div>
    
                <div id="overviewdiv" class="overviewdiv">
                    <h2>Overview</h2>
                    <p>ODBC Connect is a plugin for unreal engine that allows the developer to connect to Microsoft SQL Server through ODBC to execute statements on the Database</p> 
                </div>
            
                <div id="gettingstarteddiv" class="gettingstarteddiv">
                    <h2>Getting started</h2>
                    <p>Before we start make sure you have Microsoft SQL Server installed and ODBC Setup.</p>
                    <p>In this guide i will be using "Microsoft SQL Server 2014" and "SQL Server Native Client 11.0" ODBC Driver </p>
            
                </div>
    
    
                <h2>Using ODBC Connect</h2>
    
    
                <div class="stepsdiv">

                    <div id="preparingDatabaseTableDiv" class="preparingDatabaseTableDiv">
                        <hr>
                        <p id="preparingDatabaseTablemp" class="stepmp">Preparing Database Table</p>
                        <p>In your Database make a new table and name it "Accounts" with 3 columns</p>
                        <p>First column name will be "UID" with the datatype of "bigint"</p>
                        <p>Second column name will be "Username" with the datatype of "char(15)"</p>
                        <p>Third column name will be "Password" with the datatype of "char(255)"</p>
                        <p>Make them not nullable, The UID Auto increment and "Primary Key"</p>
                        <p>Your table should look like this</p>
                        <p><a href="/Media/AccountsTable.PNG" target="_blank"><img style="width: 20%;" src="/Media/AccountsTable.PNG" alt="AccountsTable"></a></p>
                        <p><a href="/Media/AccountsTableDesign.PNG" target="_blank"><img src="/Media/AccountsTableDesign.PNG" alt="AccountsTable Design"></a></p>
                        <p><a href="/Media/AccountsTableContent.PNG" target="_blank"><img src="/Media/AccountsTableContent.PNG" alt="AccountsTable Content"></a></p>
                        
                    </div>
    
                    <div id="preparingBlueprintDiv" class="preparingBlueprintDiv">
                        <hr>
                        <p id="preparingBlueprintmp" class="stepmp">Preparing your Blueprint</p>
                        <p>In the blueprint you want to use the plugin make 3 variables</p>
                        <p>ConnectingString <span class="string">"String"</span> </p>
                        <p>DatabaseObject " <span class="object">DatabaseObject</span> "</p>
                        <p>ColumnValues <span class="string">"ArrayOfString"</span></p>
                        <p><a href="/Media/bpclassvariables.PNG" target="_blank"><img src="/Media/bpclassvariables.PNG" alt="Blueprint class variables"></a></p>
                    </div>
    
                    <div id="connectionStringdiv" class="connectionStringdiv">
                        <hr>
                        <p id="connectionStringmp" class="stepmp">Set <span class="string">ConnectionString</span>  Value</p>
                        <p>Populate your <span class="string">ConnectionString</span> variable with your connection string, here are some examples</p>
                        <p>With Windows authentication <span class="data">DRIVER={SQL Server};Server=ServerName;Database=DatabaseName;Trusted_Connection=yes;</span></p>
                        <p>With SQL Server authentication <span class="data">{SQL Server};SERVER=ServerName;DSN=DatabaseName;UID=Username;PWD=Password;</span></p>
                        <p><a href="/Media/connectionStringValue.PNG" target="_blank"><img src="/Media/connectionStringValue.PNG" alt=""></a></p>
                    </div>
    
                    <div id="gettingDatabaseManagerDiv" class="gettingDatabaseManagerDiv">
                        <hr>
                        <p id="gettingDatabaseManagermp" class="stepmp">Getting DatabaseManager</p>
                        <p>In the blueprint you want to use the plugin right click and type "Get DatabaseManager" and hit Enter </p>
                        <p><a href="/Media/Get DatabaseManager.png" target="_blank"><img src="/Media/Get DatabaseManager.png" alt="Get DatabaseManager"></a></p>
                        <p><a href="/Media/DatabaseManagerPointer.PNG" target="_blank"><img src="/Media/DatabaseManagerPointer.PNG" alt="DatabaseManager Reference"></a></p>
                    </div>
        
                    <div id="executeStatementFunctionDiv" class="executeStatementFunctionDiv">
                        <hr>
                        <p id="executeStatementFunctionmp" class="stepmp">ExecuteStatement Function</p>
                        <p>Pull the pin from DatabaseManager and search for "ExecuteStatement" and hit enter </p>
                        <p><a href="/Media/GetExecuteStatement.png" target="_blank"><img src="/Media/GetExecuteStatement.png" alt="GetExecuteStatement"></a></p>
                        <p><a href="/Media/ExecuteStatement.png" target="_blank"><img id="executeStatementFunction" src="/Media/ExecuteStatement.png" alt="ExecuteStatement function"></a></p>
                        <p>Connect your <span class="string">ConnectionString</span> variable to <span class="string">Connection String</span> pin on the function</p>
                        <p>Type your statement in <span class="string">Statement String</span> for example <span class="data">SELECT * FROM Accounts;</span></p>
                        <p>Bind a custom event to <span class="event">On Complete</span> pin and name your event <span class="event">OnComplete</span></p>
                        <p>You should have something like this</p>
                        <p></p><a href="/Media/ExecuteStatementPins.PNG" target="_blank"><img src="/Media/ExecuteStatementPins.PNG" alt="ExecuteStatement pins connected"></a></p>
                        <p>You are now ready to query the database, now its time to get the data</p>
                    </div>
        
                    <div id="gettingDataDiv" class="gettingDataDiv">
                        <hr>
                        <p id="gettingDatamp" class="stepmp">Getting Data From Database</p>
                        <p>First we want to handle errors if there are any</p>
                        <p>On the <span class="event">OnComplete</span> event we made Connect the <span class="object">DatabaseObject</span> variable into the <span class="event">OnComplete</span> event <span class="object">DatabaseObject</span> pin</p>
                        <p>Make a Branch on the <span class="error">Success</span> pin and on <span class="error">FALSE</span> add a "Print String" node and connect <span class="string">In String</span> to <span class="string">Error Msg</span> pin on the <span class="event">OnComplete </span> event we made</p>
                        <p><a href="/Media/OnCompleteError.PNG" target="_blank"><img src="/Media/OnCompleteError.PNG" alt="Custom event call"></a></p>
                       
                        <p>Now on <span class="success">TRUE</span></p>
                        <p>Get your <span class="object">DatabaseObject</span> variable, pull the pin and type "GetColumnValuesByColumnName" and hit Enter and connect it to the <span class="success">TRUE</span> pin in the image above</p>
                        <p><a href="/Media/ColumnValuesByColumnName.png" target="_blank"><img src="/Media/ColumnValuesByColumnName.png" alt="Getting ColumnValuesByColumnName Function"></a></p>
                        <p><a href="/Media/ColumnValuesByColumnNameFunction.png" target="_blank"><img id="columnValuesByColumnNameFunction" src="/Media/ColumnValuesByColumnNameFunction.png" alt="ColumnValuesByColumnName"></a></p>
                        <p>We will be getting the values in "Password" column in the database so Type <span class="string">Password</span> in "GetColumnValuesByColumnName" function <span class="string">Column Name</span> pin</p>
                        <p>On <span class="string">Return Value</span> of the "GetColumnValuesByColumnName" function set your <span class="string">Column Values</span> variable we made in <a href="#preparingBlueprintDiv"> Here</a></p>
                        <p>After that get the length of your <span class="string">Column Values</span> and make a branch on "Length greater than 0" </p>
                        <p>You should have something like this</p>
                        <p><a href="/Media/ColumnValues.PNG" target="_blank"><img src="/Media/ColumnValues.PNG" alt="ColumnValues"></a></p>
                        
                        <p>If you have any rows in the table "Accounts" the <span class="success">TRUE</span> pin will execute, You can do whatever you want with that data!</p>
                        <p>For testing purposes lets print it like this</p>
                        <p><a href="/Media/PrintColumnValues.PNG" target="_blank"><img src="/Media/PrintColumnValues.PNG" alt="Printing ColumnValues"></a></p>
                    </div>

                    <div id="gettingAffectedRowsCountDiv" class="gettingAffectedRowsCountDiv">
                        <hr>
                        <p id="gettingAffectedRowsCountmp" class="stepmp">Getting Affected Rows</p>
                        <p>In case you execute statements like "DELETE" or "UPDATE" you might want to get the total count of rows affected</p>
                        <p>To get the affected rows you get the function "GetAffectedRowsCount" instead of "GetColumnValuesByColumnName" <a href="#columnValuesByColumnNameFunction"> Here</a> with your <span class="object">DatabaseObject</span> as a target</p>
                        <p><a href="/Media/GetAffectedRowsCount.PNG" target="_blank"><img src="/Media/GetAffectedRowsCount.PNG" alt="GetAffectedRowsCount Function"></a></p>
                    </div>

                    <div id="statementTagDiv" class="statementTagDiv">
                        <hr>
                        <p id="statementTagmp" class="stepmp">Statement Tag</p>
                        <p>Since the statement execution is MultiThreaded its hard to tell which one will finish first, to overcome that we use "Statement Tag"s</p>
                        <p>In the "ExecuteStatement" function we have a pin named "Statement Tag", you can check the function again <a href="#executeStatementFunction"> Here</a> </p>
                        <p>Lets say you have 2 statements to execute like this, the first one with "StatementTag" "SELECT" and the second one with "StatementTag" "DELETE"</p>
                        <p><a href="/Media/MultipleStatements.PNG" target="_blank"><img src="/Media/MultipleStatements.PNG" alt="MultipleStatements"></a></p>
                        <p>To know which one of those 2 statements we are getting on <span class="event">OnComplete</span> event we switch based on the tag</p>
                        <p><a href="/Media/SwitchingOnStatemnetTag.PNG" target="_blank"><img src="/Media/SwitchingOnStatemnetTag.PNG" alt="Switching On Statemnet Tag"></a></p>
                        
                    </div>
        
                </div>
            </div>
        </div>
    </div>  
</div>

</body>
</html>