<!DOCTYPE html>
<html>
<head>
<title>ODBC Connect</title>


<meta charset="utf-8">
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->

<link rel="stylesheet" href="CSS/Style.css">
</head>
<body onload="javascript:OnLoad()">

<div class="pagediv">

    <nav class="sticky-top">
        <h1>ODBC Connect</h1>
    </nav>


    <div class="contentDiv">
        <div class="tableofcontent">
            <h2>Table of content</h2>
    
            <ol>
                <li><a href="#preparingDatabaseTableDiv">Preparing Database Table</a></li>
                <li><a href="#preparingBlueprintDiv">Preparing Blueprint</a></li>
                <li><a href="#connectionStringdiv">Setting ConnectionString</a></li>
                <li><a href="#gettingDatabaseManagerDiv">Getting Database Manager</a></li>
                <li>
                    <a href="#executeStatementFunctionDiv">ExecuteStatement Function </a>
                    <!--  <ol>
                        <li>
                            <a href="#step3div">Connection String</a>
                        </li> 
                        <li>
                            <a href="#step3div">Connection String</a>
                        </li> 
                    </ol>-->
                </li>
                <li><a href="#gettingDataDiv">Getting Data From Database</a></li>
                <li><a href="#gettingAffectedRowsCountDiv">Getting Affected Rows Count</a></li>
                <li><a href="#statementTagDiv">Statement Tag</a></li>
            </ol>
    
        </div>
    
        <div class="guideDiv"> 
    
            <div>
    
                <div id="overviewdiv" class="overviewdiv">
                    <h2>Overview</h2>
                    <p>ODBC Connect is a plugin for unreal engine that allows the developer to connect to Microsoft SQL Server through ODBC to execute statements on the Database</p> 
                </div>
            
                <div id="gettingstarteddiv" class="gettingstarteddiv">
                    <h2>Getting started</h2>
                    <p>Before we start make sure you have Microsoft SQL Server installed and ODBC Setup.</p>
                    <p>In this guide i will be using "Microsoft SQL Server 2014" and "SQL Server Native Client 11.0" ODBC Driver </p>
            
                </div>
    
    
                <h2>Using ODBC Connect</h2>
    
    
                <div class="stepsdiv">

                    <div id="preparingDatabaseTableDiv" class="preparingDatabaseTableDiv">
                        <hr>
                        <p id="preparingDatabaseTablemp" class="stepmp">Preparing Database Table</p>
                        <p class="para">In your Database make a new table and name it "Accounts" with 3 columns</p>
                        <p class="para">First column name will be "UID" with the datatype of "bigint"</p>
                        <p class="para">Second column name will be "Username" with the datatype of "char(15)"</p>
                        <p class="para">Third column name will be "Password" with the datatype of "char(255)"</p>
                        <p class="para">Make them not nullable, The UID Auto increment and "Primary Key"</p>
                        <p>Your table should look like this</p>
                        <p><a href="Media/AccountsTable.png" target="_blank"><img style="width: 20%;" src="Media/AccountsTable.png" alt="AccountsTable"></a></p>
                        <p><a href="Media/AccountsTableDesign.png" target="_blank"><img src="Media/AccountsTableDesign.png" alt="AccountsTable Design"></a></p>
                        <p class="para">Add 3 entries to your table</p>
                        <p><a href="Media/AccountsTableContent.png" target="_blank"><img src="Media/AccountsTableContent.png" alt="AccountsTable Content"></a></p>
                        
                    </div>
    
                    <div id="preparingBlueprintDiv" class="preparingBlueprintDiv">
                        <hr>
                        <p id="preparingBlueprintmp" class="stepmp">Preparing your Blueprint</p>
                        <p class="para">In the blueprint you want to use the plugin make 3 variables</p>
                        <p class="para">Connection String with the datatype of <span class="string">String</span></p>
                        <p class="para">DatabaseObject with the datatype of <span class="object">DatabaseObject</span></p>
                        <p class="para">Column Values with the datatype of <span class="string">ArrayOfString</span></p>
                        <p><a href="Media/bpclassvariables.png" target="_blank"><img src="Media/bpclassvariables.png" alt="Blueprint class variables"></a></p>
                    </div>
    
                    <div id="connectionStringdiv" class="connectionStringdiv">
                        <hr>
                        <p id="connectionStringmp" class="stepmp">Set Connection String Value</p>
                        <p class="para">Populate your Connection String variable with your connection string, here are some examples</p>
                        <p class="para">With Windows authentication <span class="data">DRIVER={SQL Server};Server=ServerName;Database=DatabaseName;Trusted_Connection=yes;</span></p>
                        <p class="para">With SQL Server authentication <span class="data">{SQL Server};SERVER=ServerName;DSN=DatabaseName;UID=Username;PWD=Password;</span></p>
                        <p><a href="Media/connectionStringValue.png" target="_blank"><img src="Media/connectionStringValue.png" alt=""></a></p>
                    </div>
    
                    <div id="gettingDatabaseManagerDiv" class="gettingDatabaseManagerDiv">
                        <hr>
                        <p id="gettingDatabaseManagermp" class="stepmp">Getting DatabaseManager</p>
                        <p class="para">In the blueprint you want to use the plugin right click and type "Get DatabaseManager" and hit enter </p>
                        <p><a href="Media/Get DatabaseManager.png" target="_blank"><img src="Media/Get DatabaseManager.png" alt="Get DatabaseManager"></a></p>
                        <p><a href="Media/DatabaseManagerPointer.png" target="_blank"><img src="Media/DatabaseManagerPointer.png" alt="DatabaseManager Reference"></a></p>
                    </div>
        
                    <div id="executeStatementFunctionDiv" class="executeStatementFunctionDiv">
                        <hr>
                        <p id="executeStatementFunctionmp" class="stepmp">ExecuteStatement Function</p>
                        <p class="para">Pull the pin from DatabaseManager and search for "ExecuteStatement" and hit enter </p>
                        <p><a href="Media/GetExecuteStatement.png" target="_blank"><img src="Media/GetExecuteStatement.png" alt="GetExecuteStatement"></a></p>
                        <p><a href="Media/ExecuteStatement.png" target="_blank"><img id="executeStatementFunction" src="Media/ExecuteStatement.png" alt="ExecuteStatement function"></a></p>
                        <p class="para">Connect your Connection String variable to Connection String Pin on the function</p>
                        <p class="para">Type your statement in Statement String for example <span class="data">SELECT * FROM Accounts;</span></p>
                        <p class="para">Bind a custom event to On Complete pin and name your event OnComplete, you can do that by pulling the pin On Complete on the "ExecuteStatement" function and searching for custom event</p>
                        <p class="para">You should have something like this</p>
                        <p></p><a href="Media/ExecuteStatementPins.png" target="_blank"><img src="Media/ExecuteStatementPins.png" alt="ExecuteStatement pins connected"></a></p>
                        <p class="para">You are now ready to query the database, now its time to get the data</p>
                    </div>
        
                    <div id="gettingDataDiv" class="gettingDataDiv">
                        <hr>
                        <p id="gettingDatamp" class="stepmp">Getting Data From Database</p>
                        <p class="para">First we want to handle errors if there are any</p>
                        <p class="para">On the OnComplete event we made Connect the DatabaseObject variable into the event DatabaseObject pin</p>
                        <p class="para">Make a Branch on the Success pin and on FALSE add a Print String node and connect In String to Error Msg pin on the OnComplete event we made</p>
                        <p><a href="Media/OnCompleteError.png" target="_blank"><img src="Media/OnCompleteError.png" alt="Custom event call"></a></p>
                       
                        <p class="para">Now on TRUE</p>
                        <p class="para">Get your DatabaseObject variable, pull the pin and type GetColumnValuesByColumnName and hit enter and connect it to the TRUE pin in the image above</p>
                        <p><a href="Media/ColumnValuesByColumnName.png" target="_blank"><img src="Media/ColumnValuesByColumnName.png" alt="Getting ColumnValuesByColumnName Function"></a></p>
                        <p><a href="Media/ColumnValuesByColumnNameFunction.png" target="_blank"><img id="columnValuesByColumnNameFunction" src="Media/ColumnValuesByColumnNameFunction.png" alt="ColumnValuesByColumnName"></a></p>
                        <p class="para">We will be getting the values in "Password" column in the database so Type Password in "GetColumnValuesByColumnName" function Column Name pin</p>
                        <p class="para">On Return Value of the "GetColumnValuesByColumnName" function set your Column Values variable</p>
                        <p class="para">After that get the length of your Column Values variable and make a branch on "Length greater than 0" </p>
                        <p class="para">You should have something like this</p>
                        <p><a href="Media/ColumnValues.png" target="_blank"><img src="Media/ColumnValues.png" alt="ColumnValues"></a></p>
                        
                        <p class="para">If you have any rows in the table "Accounts" the TRUE pin will execute, You can do whatever you want with that data!</p>
                        <p class="para">For testing purposes lets print it like this</p>
                        <p><a href="Media/PrintColumnValues.png" target="_blank"><img src="Media/PrintColumnValues.png" alt="Printing ColumnValues"></a></p>
                    </div>

                    <div id="gettingAffectedRowsCountDiv" class="gettingAffectedRowsCountDiv">
                        <hr>
                        <p id="gettingAffectedRowsCountmp" class="stepmp">Getting Affected Rows</p>
                        <p class="para">In case you execute statements like "DELETE" or "UPDATE" you might want to get the total count of rows affected</p>
                        <p class="para">To get the affected rows you get the function GetAffectedRowsCount instead of GetColumnValuesByColumnName <a href="#columnValuesByColumnNameFunction"> Here</a> with your DatabaseObject variable as a target</p>
                        <p><a href="Media/GetAffectedRowsCount.png" target="_blank"><img src="Media/GetAffectedRowsCount.png" alt="GetAffectedRowsCount Function"></a></p>
                    </div>

                    <div id="statementTagDiv" class="statementTagDiv">
                        <hr>
                        <p id="statementTagmp" class="stepmp">Statement Tag</p>
                        <p class="para">Since the statement execution is MultiThreaded its hard to tell which one will finish first, to overcome that we use Statement Tags</p>
                        <p class="para">In the "ExecuteStatement" function we have a pin named Statement Tag</a> </p>
                        <p class="para">Lets say you have 2 statements to execute, the first one with SELECT Statement Tag and the second one with DELETE Statement Tag</p>
                        <p><a href="Media/MultipleStatements.png" target="_blank"><img src="Media/MultipleStatements.png" alt="MultipleStatements"></a></p>
                        <p class="para">To know which one of those 2 statements we are getting on OnComplete event we switch based on the tag</p>
                        <p><a href="Media/SwitchingOnStatemnetTag.png" target="_blank"><img src="Media/SwitchingOnStatemnetTag.png" alt="Switching On Statemnet Tag"></a></p>
                        
                    </div>
        
                </div>
            </div>
        </div>
    </div>  
</div>
<script src="js/js.js" defer></script>
</body>
</html>